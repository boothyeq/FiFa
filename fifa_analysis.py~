import pandas as pd

# Load the CSV file
file_path = r'C:\Users\acyp2\OneDrive\Desktop\BACS3013  DATA SCIENCE\fifa_players.csv'
df = pd.read_csv(file_path)

# Specify the index of the third column (0-based)
third_column_index = 2

# Get the name of the third column for clarity
third_column_name = df.columns[third_column_index]

print(f"Splitting the third column: '{third_column_name}'\n")

# Specify the delimiter you want to split by (e.g., ',', ' ', '-')
delimiter = ','  # Change this to your actual delimiter

# Split the third column using iloc
new_columns = df.iloc[:, third_column_index].str.split(delimiter, expand=True)

# Rename the new columns (optional)
new_column_names = [f'{third_column_name}_part_{i+1}' for i in range(new_columns.shape[1])]
new_columns.columns = new_column_names

# Concatenate the new columns to the original DataFrame
df = pd.concat([df, new_columns], axis=1)

# You might want to drop the original third column after splitting
# df = df.drop(columns=[third_column_name])

print("\nDataFrame after splitting the third column (first 5 rows and new columns):\n")
print(df.head())